<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><meta charset="utf-8"><script src="../js/jquery-1.12.4.min.js"></script><script src="knockout-latest.js"></script><style>*{padding:0;margin:0;font-family:'Microsoft YaHei','Helvetica Neue',Helvetica,Arial,sans-serif}body{padding:50px}label{cursor:pointer}ul.todo-list li{list-style:none;border-left-width:5px;border-left-style:solid;padding-left:10px;margin:3px}ul.todo-list li.do{border-left-color:#337ab7}ul.todo-list li.doing{border-left-color:#5cb85c}ul.todo-list li.done{border-left-color:#f0ad4e}ul.todo-list li p{overflow:hidden;white-space:nowrap;-webkit-text-overflow:ellipsis;-khtml-text-overflow:ellipsis;-icab-text-overflow:ellipsis;-moz-text-overflow:ellipsis;-o-text-overflow:ellipsis;text-overflow:ellipsis;width:300px;color:#888}.radio-box{padding:10px}.radio-box label{padding:10px}.btn{font-size:12px;color:#337ab7;cursor:pointer}.deleted{color:#999}.empty{padding:10px;color:#666;border-left:5px solid #aaa;margin:3px}</style></head><body><h2>todo list</h2><div class="radio-box"><label for="all"><input type="radio" id="all" value="all" name="status" checked data-bind="event:{change:changeStatus}">所有(<span data-bind="text:allCount"></span>)</label><label for="do"><input type="radio" id="do" value="do" name="status" data-bind="event:{change:changeStatus}">尚未开始(<span data-bind="text:doCount"></span>)</label><label for="doing"><input type="radio" id="doing" value="doing" name="status" data-bind="event:{change:changeStatus}">正在进行(<span data-bind="text:doingCount"></span>)</label><label for="done"><input type="radio" id="done" value="done" name="status" data-bind="event:{change:changeStatus}">已完成(<span data-bind="text:doneCount"></span>)</label>|<label class="deleted" for="deleted"><input type="radio" id="deleted" value="deleted" name="status" data-bind="event:{change:changeStatus}">已删除(<span data-bind="text:deletedCount"></span>)</label></div><ul class="todo-list" data-bind="foreach: todoList"><li data-bind="css:{do:status==2,doing:status==1,done:!status}"><h3 data-bind="text: name"></h3><p data-bind="text: description,attr:{title:description}"></p><a class="btn" data-bind="visible:!isDelete && status==2,click:vm.start">开始</a> <a class="btn" data-bind="visible:!isDelete && (status==1 || status==2),click:vm.finish">完成</a> <a class="btn" data-bind="visible:!isDelete && status==0,click:vm.restart">重新开始</a> <a class="btn" data-bind="visible:!isDelete,click:vm.deleteItem">删除</a> <a class="btn" data-bind="visible:isDelete,click:vm.restore">还原</a></li></ul><div class="empty" data-bind="visible:todoList().length<1">一个任务也没有，空空如也</div><hr><form action="javascript:;" data-bind="submit:addToList"><h2>new todo</h2><p>name:*</p><input type="text" name="name" id="name" data-bind="value:formData.name"><p>description:</p><textarea name="description" id="description" cols="30" rows="10" data-bind="value:formData.description"></textarea><br><input type="submit" value="提交"></form><script>var todoList=[{name:"aaaa",description:"aaaaaaaaaaaaaaaaaaaaaaaa",status:0,sort:1,isDelete:!0},{name:"bbbb",description:"bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb",status:0,sort:2,isDelete:!1},{name:"cccc",description:"cccccccccccccccccc",status:1,sort:3,isDelete:!1},{name:"dddd",description:"dddddddddddd",status:2,sort:4,isDelete:!1}],vm={changeStatus:function(t,s){var o=s.target.value;t.status=o,t.listFilter()},listFilter:function(){var t=this;if(t.todoList.removeAll(),todoList.length>0)switch(t.status){case"all":$.map(todoList,function(s){s.isDelete||t.todoList.push(s)});break;case"do":$.map(todoList,function(s){s.isDelete||2!=s.status||t.todoList.push(s)});break;case"doing":$.map(todoList,function(s){s.isDelete||1!=s.status||t.todoList.push(s)});break;case"done":$.map(todoList,function(s){s.isDelete||s.status||t.todoList.push(s)});break;case"deleted":$.map(todoList,function(s){s.isDelete&&t.todoList.push(s)})}t.todoList.sort(function(t,s){return t.status==s.status?t.sort>s.sort:1==t.status||1==s.status?1==s.status:t.status<s.status})},status:"all",todoList:ko.observableArray([]),computeCount:function(){var t=[0,0,0];$.map(todoList,function(s){s.isDelete||t[s.status]++}),this.allCount(t[0]+t[1]+t[2]),this.doCount(t[2]),this.doingCount(t[1]),this.doneCount(t[0]),this.deletedCount(todoList.length-this.allCount()),this.listFilter()},allCount:ko.observable(0),doCount:ko.observable(0),doingCount:ko.observable(0),doneCount:ko.observable(0),deletedCount:ko.observable(0),addToList:function(t){console.log(this.formData),this.formData.name().length<1||(todoList.push({name:this.formData.name(),description:this.formData.description(),status:2,sort:todoList.length,isDelete:!1}),this.computeCount())},formData:{name:ko.observable(""),description:ko.observable("")},deleteItem:function(t,s){t.isDelete=!0,vm.computeCount()},restore:function(t,s){t.isDelete=!1,vm.computeCount()},start:function(t,s){t.status=1,vm.computeCount()},finish:function(t,s){t.status=0,vm.computeCount()},restart:function(t,s){t.status=1,vm.computeCount()}};ko.applyBindings(vm),vm.listFilter(),vm.computeCount()</script></body></html>